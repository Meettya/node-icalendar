(function(){"use strict";var t,e,r,n={};t={Z14y8qH:{"./lib/icalendar":"18YwbV"},"18YwbV":{assert:"MqNAu",util:"zYbj9","./base":"ZjLJJt","./index":"H3XKY"},ZjLJJt:{"./icalendar":"18YwbV","./types":"X9DmA"},H3XKY:{"./types":"X9DmA","./base":"ZjLJJt","./icalendar":"18YwbV","./rrule":"Z23ocoq","./parser":"qkHzA","./event":"6Wkjh","./timezone":"Z2oMYNS"},X9DmA:{"./rrule":"Z23ocoq"},Z23ocoq:{"./types":"X9DmA"},qkHzA:{assert:"MqNAu",util:"zYbj9","./types":"X9DmA","./base":"ZjLJJt","./icalendar":"18YwbV"},"6Wkjh":{util:"zYbj9","./base":"ZjLJJt","./icalendar":"18YwbV","./rrule":"Z23ocoq"},Z2oMYNS:{assert:"MqNAu",util:"zYbj9","./base":"ZjLJJt","./rrule":"Z23ocoq"}},e={MqNAu:function(t,e){e.exports={equal:function(t,e){if(t!==e)throw Error("assert test fail! |"+t+"| isnt |"+e+"|");return null}}},zYbj9:function(t){t.inherits=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},Z14y8qH:function(t,e,r){t=r("./lib/icalendar")},"18YwbV":function(t,e,r){var n=(r("assert"),r("util")),a=r("./base").CalendarObject,o=(r("./base").CalendarProperty,r("./base").schema),i=t.iCalendar=function(t){a.call(this,this,"VCALENDAR"),this.calendar=this,t||(this.addProperty("VERSION","2.0"),this.addProperty("PRODID",r("./index").PRODID))};n.inherits(i,a),i.prototype.events=function(){return this.components.VEVENT||[]},i.prototype.timezone=function(t){for(var e=0;e<this.components.VTIMEZONE.length;++e){var r=this.components.VTIMEZONE[e];if(r.getPropertyValue("TZID")==t)return r}},o.VCALENDAR={factory:i,valid_properties:[],required_properties:["PRODID","VERSION"],valid_children:["VEVENT"],required_children:[]},o.VTODO={required_properties:["DTSTAMP","UID"]},o.VJOURNAL={required_properties:["DTSTAMP","UID"]},o.VFREEBUSY={required_properties:["DTSTAMP","UID"]},o.VALARM={required_properties:["ACTION","TRIGGER"]}},ZjLJJt:function(t,e,r){var n=r("./types").format_value,a=t.schema={},o=t.properties={CALSCALE:{type:"TEXT"},METHOD:{type:"TEXT"},PRODID:{type:"TEXT"},VERSION:{type:"TEXT"},ATTACH:{type:"URI"},CATEGORIES:{type:"TEXT",list:!0},CLASS:{type:"TEXT"},COMMENT:{type:"TEXT"},DESCRIPTION:{type:"TEXT"},GEO:{type:"FLOAT",list:!0},LOCATION:{type:"TEXT"},"PERCENT-COMPLETE":{type:"INTEGER"},PRIORITY:{type:"INTEGER"},RESOURCES:{type:"TEXT"},STATUS:{type:"TEXT"},SUMMARY:{type:"TEXT"},COMPLETED:{type:"DATE-TIME"},DTEND:{type:"DATE-TIME"},DUE:{type:"DATE-TIME"},DTSTART:{type:"DATE-TIME"},DURATION:{type:"DURATION"},FREEBUSY:{type:"PERIOD"},TRANSP:{type:"TEXT"},TZID:{type:"TEXT"},TZNAME:{type:"TEXT"},TZOFFSETFROM:{type:"UTC-OFFSET"},TZOFFSETTO:{type:"UTC-OFFSET"},TZURL:{type:"URI"},ATTENDEE:{type:"CAL-ADDRESS"},CONTACT:{type:"TEXT"},ORGANIZER:{type:"CAL-ADDRESS"},"RECURRENCE-ID":{type:"DATE-TIME"},"RELATED-TO":{type:"TEXT"},URL:{type:"URI"},UID:{type:"TEXT"},EXDATE:{type:"DATE-TIME",list:!0},RDATE:{type:"DATE-TIME",list:!0},RRULE:{type:"RECUR"},ACTION:{type:"TEXT"},REPEAT:{type:"INTEGER"},TRIGGER:{type:"DURATION"},CREATED:{type:"DATE-TIME"},DTSTAMP:{type:"DATE-TIME"},"LAST-MODIFIED":{type:"DATE-TIME"},SEQUENCE:{type:"INTEGER"},"REQUEST-STATUS":{type:"TEXT"}},i=75,u=t.CalendarObject=function(t,e){this.calendar=t,this.element=e,this.components={},this.properties={}};u.create=function(t,e){var r=(a[t]||{}).factory;return void 0!==r?new r(e):new u(e,t)},u.prototype.clone=function(){var t=u.create(this.element,this.calendar);for(var e in this.properties)t.addProperties(this.properties[e]);for(var r=this.getComponents(),n=0;n<r.length;++n)t.addComponent(r[n]);return t},u.prototype.addProperties=function(t){t.forEach(this.addProperty.bind(this))},u.prototype.addProperty=function(t,e,r){if(t instanceof s)t=t.clone();else{if(void 0===e)return;t=new s(t,e,r)}return this.properties[t.name]=this.properties[t.name]||[],this.properties[t.name].push(t),t},u.prototype.setProperty=function(t,e,r){this.removeProperty(t instanceof s?t.name:t),this.addProperty(t,e,r)},u.prototype.addComponent=function(t){if(!(t instanceof u)){var e=(a[t]||{}).factory;t=void 0!==e?new e(this.calendar):new u(this.calendar,t)}return t.calendar&&t.calendar!==this.calendar&&(t=t.clone()),this.components[t.element]=this.components[t.element]||[],this.components[t.element].push(t),t.calendar=this.calendar,t},u.prototype.addComponents=function(t){t.forEach(this.addComponent.bind(this))},u.prototype.getComponents=function(t){if(void 0===t){var e=[];for(var r in this.components)e=e.concat(this.components[r]);return e}return this.components[t]||[]},u.prototype.getProperty=function(t,e){return(this.properties[t]||[])[e||0]},u.prototype.getProperties=function(t){return this.properties[t]||[]},u.prototype.getPropertyValue=function(t,e){return(this.getProperty(t,e)||{}).value},u.prototype.removeProperty=function(t){delete this.properties[t]},u.prototype.validate=function(){var t=this,e=a[t.element];e&&e.required_properties&&e.required_properties.forEach(function(e){if(!t.getPropertyValue(e))throw new Error(e+" is a required property of "+t.element)});for(var r in t.components)t.components[r].forEach(function(t){t.validate()})},u.prototype.toString=function(){var t;if("VCALENDAR"==this.element)t=this.format();else{var e=new(r("./icalendar").iCalendar);e.addComponent(this),t=e.format()}return t.push(""),t.join("\r\n")},u.prototype.format=function(){var t=["BEGIN:"+this.element];for(var e in this.properties)this.properties[e].forEach(function(e){t.push.apply(t,e.format())});for(var r in this.components)for(var r=this.components[r],e=0;e<r.length;++e)t.push.apply(t,r[e].format());return t.push("END:"+this.element),t};var s=t.CalendarProperty=function(t,e,r){var n=o[t];this.type=n&&n.type?n.type:"TEXT",this.name=t,this.value=e,this.parameters=r||{}};s.prototype.clone=function(){var t=new s(this.name,this.value);t.type=this.type;for(var e in this.parameters)t.parameters[e]=this.parameters[e];return t},s.prototype.getParameter=function(t){return this.parameters[t]},s.prototype.setParameter=function(t,e){this.parameters[t]=e},s.prototype.format=function(){var t=[];for(var e in this.parameters)t.push(e+"="+this.parameters[e]);t.length&&(t=";"+t.join(";"));for(var r,a=new Buffer(this.name+t+":"+n(this.type,this.value,this.parameters)),o=0,u=[];;){for(r=i,o+r>=a.length&&(r=a.length-o);128==(192&a[o+r]);)r--;if(u.push(a.toString("utf8",o,o+r)),o+r>=a.length)break;o+=r-1,a[o]=32}return u}},H3XKY:function(t,e,r){t.format_value=r("./types").format_value,t.parse_value=r("./types").parse_value,t.RRule=r("./rrule").RRule,t.parse_calendar=r("./parser").parse_calendar,t.ParseError=r("./parser").ParseError,t.CalendarObject=r("./base").CalendarObject,t.CalendarProperty=r("./base").CalendarProperty,t.iCalendar=r("./icalendar").iCalendar,t.VEvent=r("./event").VEvent,t.VTimezone=r("./timezone").VTimezone,t.PRODID="-//Tri Tech Computers//node-icalendar//EN"},X9DmA:function(t,e,r){function n(t,e){e=e||2;var r=0>t;r&&(t*=-1),t=t.toString();var n="000000000000000000";return(r?"-":"")+n.substr(0,e-t.length)+t}var a=r("./rrule").RRule,o={BINARY:{format:function(t){return t.toString("base64")},parse:function(t){return new Buffer(t,"base64")}},BOOLEAN:{format:function(t){return t?"TRUE":"FALSE"},parse:function(t){return"TRUE"==t.toUpperCase()}},"CAL-ADDRESS":{format:function(t){var e=t.toString();return 0!=e.lastIndexOf("mailto:")&&(e="mailto:"+e),e}},DATE:{format:function(t){return t instanceof Date||(t=new Date(t)),t.getFullYear()+n(t.getMonth()+1)+n(t.getDate())},parse:function(t){var e=new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(4,2),10)-1,parseInt(t.substr(6,2),10),0,0,0);return e.date_only=!0,e}},"DATE-TIME":{format:function(t,e){return t instanceof Date||(t=new Date(t)),t.date_only||"DATE"===e.VALUE?i("DATE",t):t.getUTCFullYear()+n(t.getUTCMonth()+1)+n(t.getUTCDate())+"T"+i("TIME",t)},parse:function(t,e,r){if("DATE"===e.VALUE||t.length<=8)return o.DATE.parse(t);var n=e.TZID,a=[parseInt(t.substr(0,4),10),parseInt(t.substr(4,2),10),parseInt(t.substr(6,2),10),parseInt(t.substr(9,2),10),parseInt(t.substr(11,2),10),parseInt(t.substr(13,2),10)],i=t.length>15?"Z"===t[15]:!1;if(void 0!==n){var u=r.timezone(n);if(!u)throw new Error("Unable to load TZ data for "+n);return u.fromLocalTime(a)}return a[1]-=1,i?new Date(Date.UTC.apply(null,a)):new Date(a[0],a[1],a[2],a[3],a[4],a[5])}},DURATION:{format:function(t){var e=0>t;e&&(t*=-1);var r=Math.floor(t/604800);t-=60*r*60*24*7;var n=Math.floor(t/86400);t-=60*n*60*24;var a=Math.floor(t/3600);t-=60*a*60;var o=Math.floor(t/60);t-=60*o;var i=t,u=["P"];return e&&u.unshift("-"),r&&u.push(r+"W"),n&&u.push(n+"D"),(a||o||i)&&u.push("T"),a&&u.push(a+"H"),o&&u.push(o+"M"),i&&u.push(i+"S"),u.join("")},parse:function(t){for(var e=/(-)?P(\d+W)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+S)?)?/.exec(t).slice(1),r=[-1,604800,86400,3600,60,1],n=0,a=1;a<e.length;++a)void 0!==e[a]&&(n+=parseInt(e[a],10)*r[a]);return void 0!==e[0]&&(n*=r[0]),n}},FLOAT:{format:function(t){return t.toString()}},INTEGER:{format:function(t){return t.toString()}},PERIOD:{format:function(t){var e=i("DATE-TIME",t[0]),r=i(t[1]instanceof Date?"DATE-TIME":"DURATION",t[1]);return e+"/"+r}},RECUR:{format:function(t){return(t instanceof a?t:new a(t)).toString()},parse:function(t){return a.parse(t)}},TEXT:{format:function(t){return(t||"").toString().replace(/([\\,;])/g,"\\$1").replace(/\n/g,"\\n")},parse:function(t){return t.replace(/\\([\\,;])/g,"$1").replace(/\\[nN]/g,"\n")}},TIME:{format:function(t){return t instanceof Date||(t=new Date(t)),n(t.getUTCHours())+n(t.getUTCMinutes())+n(t.getUTCSeconds())+"Z"},parse:function(t){var e=t.length>6?"Z"===t[6]:!1;return e?new Date(Date.UTC(0,0,0,parseInt(t.substr(0,2),10),parseInt(t.substr(2,2),10),parseInt(t.substr(4,2),10))):new Date(0,0,0,parseInt(t.substr(0,2),10),parseInt(t.substr(2,2),10),parseInt(t.substr(4,2),10))}},URI:{format:function(t){return t.toString()}},"UTC-OFFSET":{format:function(t){var e=0>t;return e&&(t*=-1),(e?"-":"+")+n(t,4)}}},i=t.format_value=function(t,e,r){if(void 0===e)return"";var n=o[t||"TEXT"];if(void 0===n)throw Error("Invalid iCalendar datatype: "+t);return Array.isArray(e)&&"PERIOD"!==t||"PERIOD"===t&&e[0]&&Array.isArray(e[0])?e.map(function(t){return n.format(t,r||{})}).join(","):n.format(e,r||{})},u=t.parse_value=function(t,e,r,n,a){if(a)return e.split(",").map(function(e){return u(t,e,r,n)});var i=o[t||"TEXT"];if(void 0===i)throw Error("Invalid iCalendar datatype: "+t);r=r||{};var s=r.VALUE&&o[r.VALUE];return s&&(i=s),i.parse?i.parse(e,r,n):e}},Z23ocoq:function(t,e,r){function n(t){return Array.isArray(t)?(t=t.slice(0),t[1]--):t=[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()],new Date(Date.UTC.apply(null,t))}function a(t){var e=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());return e}function o(t){return 0>t?Math.ceil(t):Math.floor(t)}function i(t){return t.getUTCFullYear()}function u(t){return t.getUTCMonth()+1}function s(t){return t.getUTCDate()}function p(t){return t.getUTCHours()}function l(t){return t.getUTCMinutes()}function f(t){return t.getUTCSeconds()}function T(t){return t.getUTCMilliseconds()}function c(t,e){return t.setUTCFullYear(e),t}function E(t,e){return t.setUTCMonth(e-1),t}function h(t,e){return t.setUTCDate(e),t}function D(t,e){return t.setUTCHours(e),t}function A(t,e){return t.setUTCMinutes(e),t}function d(t,e){return t.setUTCSeconds(e),t}function y(t,e){return t.setUTCMilliseconds(e),t}function v(t,e){return c(t,i(t)+e)}function R(t,e){return E(t,u(t)+e)}function O(t,e){return h(t,s(t)+e)}function m(t){return t.getUTCDay()}function g(t,e){return(e-t)/864e5}function I(t){return t.sort(function(t,e){return null===t&&null===e?0:null===t?1:null===e?-1:t.valueOf()-e.valueOf()})}function M(t,e){return t&&t.length?-1!==t.indexOf(u(e)):!0}function N(t,e){if(!t||!t.length)return e;var r=t.map(function(t){var r=t-u(e);0>r&&(r+=12);var n=R(new Date(e),r);return h(n,1),n}),n=I(r).shift();return n||e}function C(t,e,r){if(!t||!t.length)return e;var n=t.map(function(t){var n=h(new Date(e),t);return n.valueOf()<=r.valueOf()?null:n}),a=I(n).shift();return a||e}function U(t,e,r){if(!t||!t.length)return e;var n=t.map(function(t){var n=t[1]-m(e);0>n&&(n+=7);var a=O(new Date(e),n);if(t[0]>0){var o=0|(s(a)-1)/7+1;if(o>t[0])return null;O(a,7*(t[0]-o))}else if(t[0]<0){for(var i=new Date(a),n=[];u(i)===u(a);)n.push(s(i)),O(i,7);h(a,n.reverse()[-t[0]-1])}return a.valueOf()<=r.valueOf()?null:a}),a=I(n).shift();return a||e}var P=r("./types"),Y=["FREQ","INTERVAL","COUNT","UNTIL","BYDAY","BYMONTH","BYMONTHDAY"],S=["SU","MO","TU","WE","TH","FR","SA"],V=t.RRule=function(t,e,r){e instanceof Date&&(e={DTSTART:e,DTEND:r}),e=e||{},this.start=e.DTSTART?n(e.DTSTART):null,this.end=e.DTEND?n(e.DTEND):null,this.exceptions=e.EXDATE||[],"string"==typeof t&&(t=V.parse(t)),this.rule={};for(var a in t||{}){if(-1==Y.indexOf(a))throw new Error(a+" is not currently supported!");this.rule[a]=b[a]?b[a].parse(t[a]):t[a]}};V.parse=function(t){for(var e=t.split(/=|;/),r={},n=0;n<e.length;n+=2)r[e[n]]=e[n+1];return r},V.prototype.setFrequency=function(t){this.rule.FREQ=t},V.prototype.valueOf=function(){return this.rule},V.prototype.toString=function(){var t=["FREQ="+this.rule.FREQ];for(var e in this.rule)"FREQ"!=e&&t.push(e+"="+((b[e]||{}).format?b[e].format(this.rule[e]):this.rule[e]));return t.join(";")},V.prototype.next=function(t){if(t=t&&n(t),(!t||t<this.start)&&(t=new Date(this.start.valueOf()-1)),this.until&&t>this.until)return null;var e=_[this.rule.FREQ];if(!e)throw new Error(this.rule.FREQ+" recurrence is not supported");t:for(;;){for(var r=e.next(this.rule,this.start,t),o=a(r),p=0;p<this.exceptions.length;p++){var l=this.exceptions[p];if(l.valueOf()==o.valueOf()||l.date_only&&i(n(l))==i(o)&&u(n(l))==u(o)&&s(n(l))==s(o)){t=r;continue t}}break}return this.until&&r>this.until?null:this.rule.COUNT&&null!==this.count_end&&(void 0===this.count_end&&(this.count_end=null,this.count_end=this.nextOccurences(this.rule.COUNT).pop()),r>n(this.count_end))?null:this.rule.UNTIL&&r>n(this.rule.UNTIL)?null:a(r)},V.prototype.nextOccurences=function(t,e){1===arguments.length&&(e=t,t=void 0);var r=[];if(e instanceof Date)for(;;){if(t=this.next(t),!(t&&e>=t))break;r.push(t)}else for(;e--&&null!==t;)t=this.next(t),t&&r.push(t);return r};var b={INTERVAL:{parse:function(t){return parseInt(t,10)}},UNTIL:{parse:function(t){return t instanceof Date?t:P.parse_value("DATE-TIME",t)},format:function(t){return P.format_value("DATE-TIME",t)}},FREQ:{parse:function(t){return t}},BYMONTH:{parse:function(t){return"number"==typeof t?[t]:t.split(",").map(function(t){return parseInt(t,10)})},format:function(t){return t.join(",")}},BYDAY:{parse:function(t){var e=t.split(",").map(function(t){var e=t.match(/([+-]?\d)?(SU|MO|TU|WE|TH|FR|SA)/);return[parseInt(e[1],10)||0,S.indexOf(e[2])]});return e.sort(function(t,e){return t[0]==e[0]?t[1]-e[1]:t[0]-e[0]}),e},format:function(t){return t.map(function(t){return(t[0]||"")+S[t[1]]}).join(",")}},EXDATE:{parse:function(t){return t.split(",").map(function(t){return 8==t.length?P.parse_value("DATE",t):P.parse_value("DATE-TIME",t)})},format:function(t){return t.map(function(t){return P.format_value(t.date_only?"DATE":"DATE-TIME",t)}).join(",")}}};b.BYMONTHDAY=b.BYMONTH,b.COUNT=b.INTERVAL;var _={DAILY:{next:function(t,e,r){var n=new Date(r);D(n,p(e)),A(n,l(e)),d(n,f(e)),y(n,T(e));var a=t.INTERVAL||1,i=o(g(n,e))%a;i&&O(n,a-i);for(var u=0;2>u&&(n=U(t.BYDAY,n,r),!(n.valueOf()>r.valueOf()));++u)O(n,a);return n}},WEEKLY:{next:function(t,e,r){var n=new Date(r);D(n,p(e)),A(n,l(e)),d(n,f(e)),y(n,T(e));var a=t.INTERVAL||1,i=o(g(e,n)/7)%a;for(i&&O(n,7*(a-i));;){if(n=U(t.BYDAY,n,r),t.BYDAY&&t.BYDAY.length||(startDayOfWeek=m(e),nextDayOfWeek=m(n),nextDayOfWeek>startDayOfWeek?O(n,startDayOfWeek-nextDayOfWeek):startDayOfWeek>nextDayOfWeek&&O(n,startDayOfWeek-nextDayOfWeek-7)),n.valueOf()>r.valueOf()&&M(t.BYMONTH,n))break;O(n,7*a)}return n}},MONTHLY:{next:function(t,e,r){var n=new Date(r);D(n,p(e)),A(n,l(e)),d(n,f(e)),y(n,T(e));var a=t.INTERVAL||1,o=u(n)-u(e)+12*(i(n)-i(e));o%a&&R(n,a-o%a);for(var c=0;2>c&&(c&&h(n,1),n=U(t.BYDAY,n,r),n=C(t.BYMONTHDAY,n,r),t.BYDAY&&t.BYDAY.length||t.BYMONTHDAY&&t.BYMONTHDAY.length||h(n,s(e)),!(n.valueOf()>r.valueOf()));++c)R(n,a);return n}},YEARLY:{next:function(t,e,r){var n=new Date(r);D(n,p(e)),A(n,l(e)),d(n,f(e)),y(n,T(e));var a=t.INTERVAL||1,o=(i(r)-i(e))%a;o&&v(n,a-o);for(var c=0;2>c&&(n=N(t.BYMONTH,n),n=C(t.BYMONTHDAY,n,r),n=U(t.BYDAY,n,r),t.BYMONTH&&t.BYMONTH.length||E(n,u(e)),t.BYDAY&&t.BYDAY.length||t.BYMONTHDAY&&t.BYMONTHDAY.length||h(n,s(e)),!(n.valueOf()>r.valueOf()));++c)h(E(v(n,a),1),1);return n}}}},qkHzA:function(t,e,r){function n(t,e,r){return function(n,a){if(n!=t)throw new c("Expected "+t+" got "+n);if(e&&e!=a)throw new c("Expected "+e+" got "+a);return r}}function a(t,e){var r=t.calendar;return function n(o,i,u){if("BEGIN"==o){var f=(p[i]||{}).factory,c=void 0!==f?new f(r):new s(r,i);return a(c,function(){return t.addComponent(c),n.apply(this,arguments)})}if("END"==o)return e;var E=l[o]||{};return i=T(E.type,i,u,r,E.list),t.addProperty(o,i,u),n}}function o(t){function e(t){i=t,u=s+1}function r(){return t.substr(u,s-u)}for(var n,a,o={},i=PROP_NAME,u=0,s=0,p=t.length;p>s;++s){var l=t[s];switch(i){case PROP_NAME:(":"==l||";"==l)&&(n=r(),i=PARAM_OR_VALUE,--s);break;case PARAM_OR_VALUE:if(":"==l)e(PROP_VALUE);else{if(";"!=l)throw new Error("Parse error");e(PARAM_NAME)}break;case PARAM_NAME:"="==l&&(a=r(),e(MAYBE_QUOTED_PARAM));break;case MAYBE_QUOTED_PARAM:'"'==l?e(QUOTED_PARAM_VALUE):i=PARAM_VALUE;break;case PARAM_VALUE:(":"==l||";"==l)&&(o[a]=r(),i=PARAM_OR_VALUE,--s);break;case QUOTED_PARAM_VALUE:'"'==l&&(o[a]=r(),i=PARAM_OR_VALUE);break;case PROP_VALUE:s=p;break;default:throw new Error("Invalid parser state")}}return[n,r(),o]}var i=(r("assert"),r("util")),u=r("./types"),s=r("./base").CalendarObject,p=r("./base").schema,l=r("./base").properties,f=r("./icalendar").iCalendar,T=u.parse_value,c=(u.format_value,t.ParseError=function(){Error.apply(this,arguments)});i.inherits(c,Error),PROP_NAME=0,PARAM_NAME=1,PARAM_VALUE=2,MAYBE_QUOTED_PARAM=3,QUOTED_PARAM_VALUE=4,PARAM_OR_VALUE=5,PROP_VALUE=6,t.parse_calendar=function(e,r){e=e.split(/\r?\n/);var i=new f(!0);if(r)if("string"==typeof r&&(r=t.parse_calendar(r)),r instanceof f)for(var u=r.getComponents("VTIMEZONE"),s=0;s<u.length;++s)i.addComponent(u[s]);else i.addComponent(u[s]);for(var p=n("BEGIN","VCALENDAR",a(i)),s=0;s<e.length-1;++s)if(e[s].length){if(void 0===p)throw new c("Mismatched BEGIN/END tags");for(var l=s;l+1<e.length&&(" "===e[l+1][0]||"	"===e[l+1][0]);)++l;var T=e[s];if(l!=s){for(var E=e.slice(s,l+1),h=1;h<E.length;++h)E[h]=E[h].substr(1);T=E.join(""),s=l}p=p.apply(null,o(T))}if(void 0!==p)throw new c("Unable to parse calendar data; END:VCALENDAR not found!");return i}},"6Wkjh":function(t,e,r){var n=r("util"),a=r("./base").CalendarObject,o=r("./base").schema,i=r("./icalendar").iCalendar,u=r("./rrule").RRule,s=t.VEvent=function(t,e){t instanceof i||null==t||(e=t,t=null),a.call(this,t,"VEVENT"),void 0!==e&&(this.addProperty("DTSTAMP",new Date),this.addProperty("UID",e))};n.inherits(s,a),s.prototype.setSummary=function(t){this.addProperty("SUMMARY",t)},s.prototype.setLocation=function(t){this.addProperty("LOCATION",t)},s.prototype.setDescription=function(t){this.addProperty("DESCRIPTION",t)},s.prototype.setDate=function(t,e){this.addProperty("DTSTART",t),e instanceof Date?this.addProperty("DTEND",e):this.addProperty("DURATION",e)},s.prototype.rrule=function(){var t=this.getPropertyValue("RRULE");if(!t)return null;for(var e,r=[],n=0;e=this.getPropertyValue("EXDATE",n++);)r.push.apply(r,e);return new u(t,{DTSTART:this.getPropertyValue("DTSTART"),DTEND:this.getPropertyValue("DTEND"),EXDATE:r})},s.prototype.inTimeRange=function(t,e){var r=this.rrule();if(r){var n=r.next(t);return null!==n&&(!e||e>=n)}var a=this.getPropertyValue("DTSTART"),o=this.getPropertyValue("DTEND");if(!o){var i=this.getPropertyValue("DURATION");if(0===i)return(!t||a>=t)&&(!e||e>a);o=new Date(i?a.valueOf()+1e3*this.getPropertyValue("DURATION"):a.valueOf()+864e5)}return(!t||o>t)&&(!e||e>a)},s.prototype.reply=function(t,e,r){var n=this.clone(!0);r=r||{},e===!0||void 0===e?e="ACCEPTED":e===!1&&(e="DECLINED"),n.setProperty("ATTENDEE",t,{PARTSTAT:e,CN:r.CN||t}),n.setProperty("DTSTAMP",new Date),n.setProperty("LAST-MODIFIED",new Date);var a=new i;return a.addProperty("METHOD","REPLY"),this.calendar&&a.addComponents(this.calendar.getComponents("VTIMEZONE")),a.addComponent(n),a},o.VEVENT={factory:s,valid_properties:[],required_properties:["DTSTAMP","UID"],valid_children:[],required_children:[]}},Z2oMYNS:function(t,e,r){var n=r("assert"),a=r("util"),o=r("./base").CalendarObject,i=r("./base").schema,u=r("./rrule").RRule,s=t.VTimezone=function(t,e){o.call(this,t,"VTIMEZONE"),this.addProperty("TZID",e)};a.inherits(s,o),s.prototype.getRRule=function(t){var e=this.getComponents(t)[0];return e&&e.getPropertyValue("RRULE")?new u(e.getPropertyValue("RRULE"),e.getPropertyValue("DTSTART"),e.getPropertyValue("DTEND")):null},s.prototype.getOffsetForDate=function(t){if(!this.getComponents("DAYLIGHT").length)return this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO");n.equal(1,this.components.STANDARD.length),n.equal(1,this.components.DAYLIGHT.length);var e=this.getRRule("STANDARD"),r=this.getRRule("DAYLIGHT");if(null===e||null===r){var a=this.getComponents("STANDARD")[0];return a.getPropertyValue("TZOFFSETTO")}return e=e.next(t),r=r.next(t),this.getComponents(e>r?"STANDARD":"DAYLIGHT")[0].getPropertyValue("TZOFFSETTO")},s.prototype.fromLocalTime=function(t){var e=this.getOffsetForDate(t),r=e%100;return e=(e-r)/100,new Date(Date.UTC(t[0],t[1]-1,t[2],t[3]-e,t[4]-r,t[5]))},i.VTIMEZONE={factory:s}}};var a=function(t){var e,r;return e=function(t){return function(e,r){if(null==t[e])throw Error("no dependencies list for parent |"+e+"|");if(null==t[e][r])throw Error("no one module resolved, name - |"+r+"|, parent - |"+e+"|");return t[e][r]}},r=function(t,e,r){var n,a,o=this;return n=function(n,o){var i,u;if(!((i=t[n])||(u=e(o,n),i=t[u])))throw Error("can`t find module source code: original_name - |"+n+"|, resolved_name - |"+u+"|");return u=null!=u?u:n,null!=r?null!=r[u]?r[u]:r[u]=a(i,u):a(i,u)},a=function(t,e){var r,a,i;return t.call(o,r={},a={exports:r},function(t){return n(t,e)}),null!=(i=a.exports)?i:r},n},t.require_builder=function(t,n,a){return r.call(this,n,e(t),a)},t}({});r=a.require_builder.call(this,t,e,n),this.icalendar=r("Z14y8qH")}).call(this);